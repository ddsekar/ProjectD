const flatFields = [
  'finance.revenue.q1',
  'finance.revenue.q2',
  'finance.expenses.q1',
  'finance.expenses.q2',
  'marketing.ads.q1'
];

function buildColumnGroups(fields) {
  const root = {};

  for (const path of fields) {
    const parts = path.split('.');
    let current = root;

    for (let i = 0; i < parts.length; i++) {
      const key = parts[i];
      current.children = current.children || [];
      let next = current.children.find(c => c.headerName === key);

      if (!next) {
        next = i === parts.length - 1
          ? { headerName: key, field: path }
          : { headerName: key };
        current.children.push(next);
      }

      current = next;
    }
  }

  return root.children;
}

const columnDefs = buildColumnGroups(flatFields);

const gridOptions = {
  columnDefs,
  // other grid options...
};
